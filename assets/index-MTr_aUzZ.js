var Ve=Object.defineProperty;var qe=(m,t,e)=>t in m?Ve(m,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):m[t]=e;var W=(m,t,e)=>(qe(m,typeof t!="symbol"?t+"":t,e),e),ye=(m,t,e)=>{if(!t.has(m))throw TypeError("Cannot "+e)};var a=(m,t,e)=>(ye(m,t,"read from private field"),e?e.call(m):t.get(m)),d=(m,t,e)=>{if(t.has(m))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(m):t.set(m,e)},g=(m,t,e,i)=>(ye(m,t,"write to private field"),i?i.call(m,e):t.set(m,e),e);var v=(m,t,e)=>(ye(m,t,"access private method"),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();var w={Default:"default",Grab:"grab",Draw:"draw",Zoom:"zoom",Pipette:"pipette",Crop:"crop"},f=function(m,t,e){var i=document.createElement(m);return i.classList.add(...t),e&&(i.textContent=e),i},de=(m,t,e)=>{function i(s){const r=s.toString(16);return r.length==1?"0"+r:r}return"#"+i(m)+i(t)+i(e)},Re=.1,Be=50,E=60,H,X;class $e{constructor(){d(this,H,[0,0]);d(this,X,!1)}onMouseDown(t){t.target.style.cursor="grabbing",g(this,X,!0),g(this,H,[t.clientX,t.clientY])}onMouseUp(t){t.target.style.cursor="grab",g(this,X,!1)}onMouseMove(t,{crds:e,scaledWidth:i,scaledHeight:s,canvas:r},o){if(!(!a(this,X)||i<r.element.width&&s<r.element.height)){var[l,u]=a(this,H),h=i<r.element.width?0:t.clientX-l,p=s<r.element.height?0:t.clientY-u,c=e[0]+h,b=e[1]+p,M=e[0],D=e[1];i>=r.element.width&&(e[0]=Math.min(E,Math.max(c,r.element.width-i-E))),s>=r.element.height&&(e[1]=Math.min(E,Math.max(b,r.element.height-s-E))),g(this,H,[t.clientX,t.clientY]),(M!==c||D!==b)&&o()}}}H=new WeakMap,X=new WeakMap;var je=40,Je=24,Y,J,De,K,Ie;class Ke{constructor(){d(this,J);d(this,K);d(this,Y,!1);W(this,"canvasDrawSize",je)}initCanvasDraw(t){var{canvasDraw:e,scale:i}=t,s=this.canvasDrawSize*i,r=2;e.element.width=s,e.element.height=s;var o=e.element.width/2,l=e.element.height/2;e.context.lineWidth=r*i,e.context.strokeStyle="#D0D5DD",e.context.clearRect(0,0,e.element.width,e.element.height),e.context.beginPath(),e.context.arc(o,l,o-i,0,Math.PI*2),e.context.closePath(),e.context.stroke()}onMouseDown(t,e,i){var{originalCanvas:s}=e,[r,o]=v(this,J,De).call(this,t.clientX,t.clientY,e);g(this,Y,!0),s.context.beginPath(),s.context.moveTo(r,o),v(this,K,Ie).call(this,t.clientX,t.clientY,e),i()}onMouseUp(t,{originalCanvas:e}){e.context.closePath(),g(this,Y,!1)}onMouseMove(t,e,i){var{canvasDraw:s}=e;s.element.style.visibility="visible",s.element.style.top=t.clientY+"px",s.element.style.left=t.clientX+"px",a(this,Y)&&(v(this,K,Ie).call(this,t.clientX,t.clientY,e),i())}}Y=new WeakMap,J=new WeakSet,De=function(t,e,{crds:i,scale:s}){return[(t-i[0])/s,(e-i[1])/s]},K=new WeakSet,Ie=function(t,e,i){var{originalCanvas:s,color:r}=i,[o,l]=v(this,J,De).call(this,t,e,i);s.context.lineWidth=this.canvasDrawSize,s.context.strokeStyle=r,s.context.lineCap="round",s.context.lineJoin="round",s.context.lineTo(o,l),s.context.stroke()};class Qe{constructor(){W(this,"mode","in")}onMouseDown(t,e,i,s){t.preventDefault();var{scale:r,crds:o,canvas:l,originalCanvas:u}=e,h=r>5?2:.2;this.mode==="out"&&(h*=-1),e.scale=Math.min(Math.max(Re,Math.round((r+h)*100)/100),Be),e.scaledWidth=u.element.width*e.scale,e.scaledHeight=u.element.height*e.scale,o[0]+=l.element.width/2-t.clientX,o[1]+=l.element.height/2-t.clientY,i(r),s()}}var et=2,G,k,Q,Ee;class tt{constructor(){d(this,Q);d(this,G,!1);d(this,k,Je)}initPipette(t){var{canvasPipette:e}=t,i=a(this,k)/2,s=a(this,k)/2;e.context.clearRect(0,0,a(this,k),a(this,k)),e.context.beginPath(),e.context.moveTo(i,0),e.context.lineTo(i,a(this,k)),e.context.moveTo(0,s),e.context.lineTo(a(this,k),s),e.context.closePath(),e.context.stroke()}onMouseDown(t,e){var{canvas:i}=e;g(this,G,!0);var[s,r,o]=i.context.getImageData(t.clientX,t.clientY,1,1).data;v(this,Q,Ee).call(this,e,de(s,r,o))}onMouseUp(){g(this,G,!1)}onMouseMove(t,e){var{canvasPipette:i,canvas:s}=e;i.element.style.visibility="visible",i.element.style.top=t.clientY+"px",i.element.style.left=t.clientX+"px";var[r,o,l]=s.context.getImageData(t.clientX,t.clientY,1,1).data,u=[r,o,l].map(h=>255-h);i.context.lineWidth=et,i.context.strokeStyle=de(...u),this.initPipette(e),a(this,G)&&v(this,Q,Ee).call(this,e,de(r,o,l))}}G=new WeakMap,k=new WeakMap,Q=new WeakSet,Ee=function(t,e){var i=document.getElementById("stroke-button");t.color=e,i.style.backgroundColor=e};var x={TOP_MID:0,BOTTOM_MID:1,LEFT_TOP:2,LEFT_MID:3,LEFT_BOTTOM:4,RIGHT_TOP:5,RIGHT_MID:6,RIGHT_BOTTOM:7,MOVE:8},at=50,nt=15,T,U,A,me,ze;class it{constructor(){d(this,me);d(this,T,x.MOVE);d(this,U,!1);W(this,"cropCrds",null);d(this,A,[0,0])}drawCrop(t){requestAnimationFrame(()=>{var{canvas:e,scale:i,crds:s}=t,r=1,[o,l]=this.cropCrds.map(([b,M])=>[b*i+s[0],M*i+s[1]]),u=(l[0]-o[0])/2,h=(l[1]-o[1])/2;e.context.strokeStyle="#D0D5DD",e.context.lineWidth=r,e.context.beginPath(),e.context.moveTo(o[0],o[1]),e.context.lineTo(l[0],o[1]),e.context.lineTo(l[0],l[1]),e.context.lineTo(o[0],l[1]),e.context.closePath(),e.context.stroke();var p=3,c=nt;e.context.lineWidth=p,e.context.beginPath(),o[0]+c>=o[0]+u-c?(e.context.moveTo(o[0],o[1]),e.context.lineTo(l[0],o[1]),e.context.moveTo(o[0],l[1]),e.context.lineTo(l[0],l[1])):(e.context.moveTo(o[0],o[1]),e.context.lineTo(o[0]+c,o[1]),e.context.moveTo(l[0],o[1]),e.context.lineTo(l[0]-c,o[1]),e.context.moveTo(o[0]+u-c,o[1]),e.context.lineTo(o[0]+u+c,o[1]),e.context.moveTo(o[0],l[1]),e.context.lineTo(o[0]+c,l[1]),e.context.moveTo(l[0],l[1]),e.context.lineTo(l[0]-c,l[1]),e.context.moveTo(o[0]+u-c,l[1]),e.context.lineTo(o[0]+u+c,l[1])),o[1]+c>=o[1]+h-c?(e.context.moveTo(o[0],o[1]),e.context.lineTo(o[0],l[1]),e.context.moveTo(l[0],o[1]),e.context.lineTo(l[0],l[1])):(e.context.moveTo(o[0],o[1]),e.context.lineTo(o[0],o[1]+c),e.context.moveTo(l[0],o[1]),e.context.lineTo(l[0],o[1]+c),e.context.moveTo(o[0],l[1]),e.context.lineTo(o[0],l[1]-c),e.context.moveTo(l[0],l[1]),e.context.lineTo(l[0],l[1]-c),e.context.moveTo(o[0],o[1]+h-c),e.context.lineTo(o[0],o[1]+h+c),e.context.moveTo(l[0],o[1]+h-c),e.context.lineTo(l[0],o[1]+h+c)),e.context.closePath(),e.context.stroke()})}initCrop(t){var{originalCanvas:e}=t;this.cropCrds=[[0,0],[e.element.width,e.element.height]],this.drawCrop(t)}onMouseDown(t){t.preventDefault(),g(this,U,!0),g(this,A,[t.clientX,t.clientY])}onMouseUp(){g(this,U,!1),a(this,A).current=[0,0]}onMouseMove(t,e,i){var{clientX:s,clientY:r}=t;if(a(this,U)){v(this,me,ze).call(this,s,r,e,i);return}var{canvas:o,scale:l,crds:u}=e,[h,p]=this.cropCrds.map(([b,M])=>[b*l+u[0],M*l+u[1]]),c="";s<=h[0]&&r<=h[1]?(c="nwse-resize",g(this,T,x.LEFT_TOP)):s>=p[0]&&r<=h[1]?(c="nesw-resize",g(this,T,x.RIGHT_TOP)):s<=h[0]&&r>=p[1]?(c="nesw-resize",g(this,T,x.LEFT_BOTTOM)):s>=p[0]&&r>=p[1]?(c="nwse-resize",g(this,T,x.RIGHT_BOTTOM)):s<=h[0]&&r>=h[1]&&r<=p[1]?(c="ew-resize",g(this,T,x.LEFT_MID)):s>=p[0]&&r>=h[1]&&r<=p[1]?(c="ew-resize",g(this,T,x.RIGHT_MID)):s>=h[0]&&s<=p[0]&&r<=h[1]?(c="ns-resize",g(this,T,x.TOP_MID)):s>=h[0]&&s<=p[0]&&r>=p[1]?(c="ns-resize",g(this,T,x.BOTTOM_MID)):(c="move",g(this,T,x.MOVE)),o.element.style.cursor=c}}T=new WeakMap,U=new WeakMap,A=new WeakMap,me=new WeakSet,ze=function(t,e,i,s){var{scale:r,originalCanvas:o}=i,[l,u]=a(this,A),[h,p]=this.cropCrds,c=(t-l)/r,b=(e-u)/r,M=at/r,D=()=>{var C=0;c<0?C=Math.max(h[0]+c,0):C=Math.min(h[0]+c,p[0]-M),h[0]=C};const z=()=>{var C=0;c<0?C=Math.max(p[0]+c,h[0]+M):C=Math.min(p[0]+c,o.element.width),p[0]=C},V=()=>{var C=0;b<0?C=Math.max(h[1]+b,0):C=Math.min(h[1]+b,p[1]-M),h[1]=C},q=()=>{var C=0;b<0?C=Math.max(p[1]+b,h[1]+M):C=Math.min(p[1]+b,o.element.height),p[1]=C};switch(a(this,T)){case x.LEFT_MID:{D();break}case x.RIGHT_MID:{z();break}case x.TOP_MID:{V();break}case x.BOTTOM_MID:{q();break}case x.LEFT_TOP:{D(),V();break}case x.RIGHT_TOP:{z(),V();break}case x.LEFT_BOTTOM:{D(),q();break}case x.RIGHT_BOTTOM:{z(),q();break}case x.MOVE:{var $=h[0]+c,O=p[0]+c,j=h[1]+b,Te=p[1]+b;O<o.element.width&&$>0&&(h[0]=$),$>0&&O<o.element.width&&(p[0]=O),Te<o.element.height&&j>0&&(h[1]=j),j>0&&Te<o.element.height&&(p[1]=Te);break}}g(this,A,[t,e]),s(),this.drawCrop(i)};var L,n,N,I,F,R,y,ee,ke,ue,We,te,Le,ae,Pe,ne,Oe,ie,Se;class st{constructor(t,{name:e,type:i}){d(this,ee);d(this,ue);d(this,te);d(this,ae);d(this,ne);d(this,ie);d(this,L,w.Default);d(this,n,{scale:0,color:"#000",scaledWidth:0,scaledHeight:0,crds:[0,0],canvas:{element:null,context:null},originalCanvas:{element:null,context:null},canvasDraw:{element:null,context:null},canvasPipette:{element:null,context:null}});W(this,"name","");W(this,"type","");d(this,N,new $e);d(this,I,new Ke);d(this,F,new Qe);d(this,R,new tt);d(this,y,new it);this.name=e,this.type=i;var s=document.getElementById("canvas"),r=document.getElementById("canvas-draw"),o=document.createElement("canvas"),l=document.getElementById("canvas-pipette");a(this,n).canvas={element:s,context:s.getContext("2d")},a(this,n).originalCanvas={element:o,context:o.getContext("2d")},a(this,n).canvasDraw={element:r,context:r.getContext("2d")},a(this,n).canvasPipette={element:l,context:l.getContext("2d")},v(this,ee,ke).call(this),v(this,ue,We).call(this,t),v(this,ne,Oe).call(this),v(this,te,Le).call(this)}getDataURL(){return a(this,n).originalCanvas.element.toDataURL(this.type)}getColor(){return a(this,n).color}getCanvasDrawSize(){return a(this,I).canvasDrawSize}setCanvasDrawSize(t){a(this,I).canvasDrawSize=t,a(this,I).initCanvasDraw(a(this,n))}resetCropCrds(){this.drawImage(),a(this,y).initCrop(a(this,n))}applyCropCrds(){var[t,e]=a(this,y).cropCrds,i=e[0]-t[0],s=e[1]-t[1];if(i>=1&&s>=1){var r=a(this,n).originalCanvas.context.getImageData(t[0],t[1],i,s);a(this,n).originalCanvas.element.width=i,a(this,n).originalCanvas.element.height=s,a(this,n).originalCanvas.context.putImageData(r,0,0)}var o=a(this,n).originalCanvas.element.width*a(this,n).scale,l=a(this,n).originalCanvas.element.height*a(this,n).scale;a(this,n).scaledWidth=o,a(this,n).scaledHeight=l;var u=(a(this,n).canvas.element.width-o)/2,h=(a(this,n).canvas.element.height-l)/2;a(this,n).crds=[u,h],this.drawImage(),a(this,y).initCrop(a(this,n))}setColor(t){a(this,n).color=t}setZoomMode(t){a(this,F).mode=t,a(this,n).canvas.element.style.cursor=`zoom-${t}`}drawImage(){requestAnimationFrame(()=>{var[t,e]=a(this,n).crds;a(this,n).canvas.context.imageSmoothingEnabled=!1,a(this,n).canvas.context.clearRect(0,0,a(this,n).canvas.element.width,a(this,n).canvas.element.height),a(this,n).canvas.context.fillStyle="#fff",a(this,n).canvas.context.fillRect(0,0,a(this,n).canvas.element.width,a(this,n).canvas.element.height),a(this,n).canvas.context.drawImage(a(this,n).originalCanvas.element,t,e,Math.floor(a(this,n).scaledWidth),Math.floor(a(this,n).scaledHeight))})}setDrawState(t){switch(g(this,L,t),a(this,n).canvasDraw.element.style.visibility="hidden",a(this,n).canvasPipette.element.style.visibility="hidden",this.drawImage(),t){case w.Default:{a(this,n).canvas.element.style.cursor="default";break}case w.Grab:{a(this,n).canvas.element.style.cursor="grab";break}case w.Draw:{a(this,n).canvas.element.style.cursor="none",a(this,I).initCanvasDraw(a(this,n));break}case w.Zoom:{a(this,n).canvas.element.style.cursor=`zoom-${a(this,F).mode}`;break}case w.Pipette:{a(this,n).canvas.element.style.cursor="none",a(this,R).initPipette(a(this,n));break}case w.Crop:{a(this,y).initCrop(a(this,n));break}}}onMouseDown(t){switch(a(this,L)){case w.Grab:{a(this,N).onMouseDown(t);break}case w.Draw:{a(this,I).onMouseDown(t,a(this,n),this.drawImage.bind(this));break}case w.Crop:{a(this,y).onMouseDown(t);break}case w.Zoom:{a(this,F).onMouseDown(t,a(this,n),v(this,ie,Se).bind(this),this.drawImage.bind(this));break}case w.Pipette:{a(this,R).onMouseDown(t,a(this,n));break}}Array.prototype.forEach.call(document.getElementsByClassName("button"),e=>{e.disabled=!0})}onMouseUp(t){switch(a(this,L)){case w.Grab:{a(this,N).onMouseUp(t);break}case w.Draw:{a(this,I).onMouseUp(t,a(this,n));break}case w.Crop:{a(this,y).onMouseUp();break}case w.Pipette:{a(this,R).onMouseUp();break}}Array.prototype.forEach.call(document.getElementsByClassName("button"),e=>{e.disabled=!1})}onMouseMove(t){switch(a(this,L)){case w.Grab:{a(this,N).onMouseMove(t,a(this,n),this.drawImage.bind(this));break}case w.Draw:{a(this,I).onMouseMove(t,a(this,n),this.drawImage.bind(this));break}case w.Crop:{a(this,y).onMouseMove(t,a(this,n),this.drawImage.bind(this));break}case w.Pipette:{a(this,R).onMouseMove(t,a(this,n));break}}}onResize(){switch(v(this,ee,ke).call(this),v(this,ne,Oe).call(this),v(this,te,Le).call(this),a(this,L)){case w.Crop:{this.drawImage(),a(this,y).initCrop(a(this,n));break}default:this.drawImage();break}}onWheel(t){t.preventDefault();var e=a(this,n).scale,i=-5e-4;switch(a(this,n).scale>3&&(i*=10),v(this,ae,Pe).call(this,Math.min(Math.max(Re,a(this,n).scale+t.deltaY*i),Be)),v(this,ie,Se).call(this,e),a(this,L)){case w.Crop:{this.drawImage(),a(this,y).drawCrop(a(this,n));break}case w.Draw:a(this,I).initCanvasDraw(a(this,n));default:this.drawImage();break}}}L=new WeakMap,n=new WeakMap,N=new WeakMap,I=new WeakMap,F=new WeakMap,R=new WeakMap,y=new WeakMap,ee=new WeakSet,ke=function(){var t=a(this,n).canvas.element.parentElement,e=t.getBoundingClientRect();a(this,n).canvas.element.width=e.width,a(this,n).canvas.element.height=e.height},ue=new WeakSet,We=function(t){a(this,n).originalCanvas.element.width=t.width,a(this,n).originalCanvas.element.height=t.height,a(this,n).originalCanvas.context.drawImage(t,0,0,t.width,t.height)},te=new WeakSet,Le=function(){var t=(a(this,n).canvas.element.width-a(this,n).scaledWidth)/2,e=(a(this,n).canvas.element.height-a(this,n).scaledHeight)/2;a(this,n).crds=[t,e]},ae=new WeakSet,Pe=function(t){var e=a(this,n).originalCanvas.element.width*t,i=a(this,n).originalCanvas.element.height*t;a(this,n).scale=t,a(this,n).scaledWidth=e,a(this,n).scaledHeight=i},ne=new WeakSet,Oe=function(){var t=a(this,n).canvas.element.width/(a(this,n).originalCanvas.element.width+E*2),e=a(this,n).canvas.element.height/(a(this,n).originalCanvas.element.height+E*2);v(this,ae,Pe).call(this,Math.min(t,e,1))},ie=new WeakSet,Se=function(t){var e=a(this,n).scale/t,i=a(this,n).canvas.element.width-a(this,n).scaledWidth,s=a(this,n).canvas.element.height-a(this,n).scaledHeight;if(a(this,n).scaledWidth<a(this,n).canvas.element.width)a(this,n).crds[0]=i/2;else{var r=a(this,n).canvas.element.width/2,o=r+(a(this,n).crds[0]-r)*e;a(this,n).crds[0]=Math.max(Math.min(E,o),i-E)}if(a(this,n).scaledHeight<a(this,n).canvas.element.height)a(this,n).crds[1]=s/2;else{var l=a(this,n).canvas.element.height/2,u=l+(a(this,n).crds[1]-l)*e;a(this,n).crds[1]=Math.max(Math.min(E,u),s-E)}};var pe,_,B,se,oe,re,le,he,ge,He,we,Xe,be,Ye,_e,Ge,P,S,xe,Ue,fe,Ne,Z,ve,Me,Fe,Ce,Ze,ce,Ae;class ot{constructor(){d(this,ge);d(this,we);d(this,be);d(this,_e);d(this,P);d(this,xe);d(this,fe);d(this,Z);d(this,Me);d(this,Ce);d(this,ce);d(this,pe,["#000","#ff0000","#008000","#0000ff","#ffff00"]);d(this,_,null);d(this,B,[]);d(this,se,null);d(this,oe,null);d(this,re,null);d(this,le,null);d(this,he,null);v(this,ge,He).call(this)}}pe=new WeakMap,_=new WeakMap,B=new WeakMap,se=new WeakMap,oe=new WeakMap,re=new WeakMap,le=new WeakMap,he=new WeakMap,ge=new WeakSet,He=function(){var t=document.getElementById("menu-state"),e=t.getElementsByClassName("button"),i=document.getElementById("menu-button"),s=document.getElementById("menu-dropdown");t.style.display="none",Array.prototype.forEach.call(e,r=>{r.addEventListener("click",()=>{v(this,Z,ve).call(this),a(this,_).setDrawState.call(a(this,_),r.dataset.drawstate),v(this,Me,Fe).call(this,r.dataset.drawstate)})}),Array.prototype.forEach.call(s.children[0].children,r=>{switch(r.dataset.label){case"open":{r.addEventListener("change",v(this,be,Ye).bind(this));break}case"download":{r.style.display="none",r.addEventListener("click",v(this,we,Xe).bind(this));break}}}),window.addEventListener("click",v(this,Ce,Ze).bind(this)),i.addEventListener("click",v(this,ce,Ae).bind(this))},we=new WeakSet,Xe=function(){var t=document.createElement("a");t.href=a(this,_).getDataURL(),t.download=a(this,_).name,t.click()},be=new WeakSet,Ye=function(t){var e=t.target.files;if(e&&e.length>0){var i=e[0],s=new FileReader;s.onload=()=>{var r=s.result;try{var o=new Image;o.src=r,o.onload=l=>{var u=document.getElementById("canvas"),h=new st(l.target,{name:i.name,type:i.type}),p=h.onResize.bind(h),c=h.onWheel.bind(h),b=h.onMouseDown.bind(h),M=h.onMouseUp.bind(h),D=h.onMouseMove.bind(h);a(this,B).push([window,"resize",a(this,se)],[u,"wheel",a(this,oe)],[u,"mousedown",a(this,re)],[u,"mouseup",a(this,le)],[u,"mousemove",a(this,he)]),g(this,_,h),v(this,Z,ve).call(this),v(this,_e,Ge).call(this),v(this,ce,Ae).call(this),a(this,_).drawImage(),window.addEventListener("resize",p,{passive:!1}),u.addEventListener("wheel",c),u.addEventListener("mousedown",b),u.addEventListener("mouseup",M),u.addEventListener("mousemove",D),g(this,se,p),g(this,oe,c),g(this,re,b),g(this,le,M),g(this,he,D)},o.onerror=()=>{console.error("Failed to load image.")}}catch(l){console.error(l)}},s.onerror=r=>{var l;var o=(l=r.target)==null?void 0:l.error;console.error(o)},s.readAsDataURL(i)}},_e=new WeakSet,Ge=function(){var t=document.getElementById("menu-state"),e=document.getElementById("menu-dropdown");t.style.display="flex",Array.prototype.forEach.call(e.children[0].children,i=>{i.style.display="flex"})},P=new WeakSet,S=function(t,e,i){t.addEventListener(e,i),a(this,B).push([t,e,i])},xe=new WeakSet,Ue=function(t){var e=document.getElementById("stroke-button"),i=t.target.style.backgroundColor.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/),s=de(+i[1],+i[2],+i[3]);a(this,_).setColor(s),e.style.backgroundColor=s},fe=new WeakSet,Ne=function(t){var e=t.target.parentElement.children[0],i=e.textContent.split(" ");i[1]=t.target.value+"px",e.textContent=i.join(" "),a(this,_).setCanvasDrawSize(+t.target.value)},Z=new WeakSet,ve=function(){for(var t=document.getElementById("menu-panel");a(this,B).length>0;){var[e,i,s]=a(this,B).pop();e.removeEventListener(i,s)}for(;t.firstChild;)t.removeChild(t.firstChild);t.classList.add("hide")},Me=new WeakSet,Fe=function(t){var e=document.getElementById("menu-panel");switch(t){case w.Pipette:case w.Draw:{e.classList.remove("hide");var i=f("fieldset",["menu__panel-container"]),s=f("legend",["menu__panel-container__legend"],"Stroke"),r=f("div",["menu__panel-container__row"]);a(this,pe).forEach($=>{var O=f("button",["menu__panel-container__button"]);O.style.backgroundColor=$;var j=v(this,xe,Ue).bind(this);v(this,P,S).call(this,O,"click",j),r.append(O)});var o=f("button",["menu__panel-container__button"]);if(o.setAttribute("id","stroke-button"),o.style.backgroundColor=a(this,_).getColor(),r.append(o),i.append(s,r),e.append(i),t!==w.Pipette){var l=a(this,_).getCanvasDrawSize().toString(),u=f("fieldset",["menu__panel-container"]),s=f("legend",["menu__panel-container__legend"],`Size ${l}px`),h=document.createElement("input"),p=v(this,fe,Ne).bind(this);h.setAttribute("type","range"),h.setAttribute("min","5"),h.setAttribute("max","1000"),h.setAttribute("value",l),h.addEventListener("input",p),v(this,P,S).call(this,h,"input",p),u.append(s,h),e.append(u)}break}case w.Crop:{e.classList.remove("hide");var i=f("fieldset",["menu__panel-container"]),s=f("legend",["menu__panel-container__legend"],"Crop"),c=f("div",["menu__panel-container__row","menu__panel-container__row--crop"]),b=f("button",["menu__panel-container__button","menu__panel-container__button--crop"],"Apply"),M=f("button",["menu__panel-container__button","menu__panel-container__button--crop"],"Reset");c.append(b,M),i.append(s,c),v(this,P,S).call(this,b,"click",()=>{a(this,_).applyCropCrds.call(a(this,_)),v(this,Z,ve).call(this)}),v(this,P,S).call(this,M,"click",a(this,_).resetCropCrds.bind(a(this,_))),e.append(i);break}case w.Zoom:{e.classList.remove("hide");var i=f("fieldset",["menu__panel-container"]),s=f("legend",["menu__panel-container__legend"],"Zoom"),c=f("div",["menu__panel-container__row","menu__panel-container__row--crop"]),D=f("button",["menu__panel-container__button","menu__panel-container__button--crop"],"Plus"),z=f("button",["menu__panel-container__button","menu__panel-container__button--crop"],"Minus");c.append(D,z),i.append(s,c);var V=a(this,_).setZoomMode.bind(a(this,_),"in"),q=a(this,_).setZoomMode.bind(a(this,_),"out");v(this,P,S).call(this,D,"click",V),v(this,P,S).call(this,z,"click",q),e.append(i);break}default:{e.classList.add("hide");break}}},Ce=new WeakSet,Ze=function(t){var e=document.getElementById("menu-dropdown");!e.contains(t.target)&&!t.target.closest("#menu-button")&&e.classList.add("hide")},ce=new WeakSet,Ae=function(){var t=document.getElementById("menu-dropdown");t.classList.contains("hide")?t.classList.remove("hide"):t.classList.add("hide")};new ot;
